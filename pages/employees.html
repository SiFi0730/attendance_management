<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¾“æ¥­å“¡ç®¡ç† - å‹¤æ€ ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
  <link rel="stylesheet" href="../styles/common.css">
  <link rel="stylesheet" href="../styles/components.css">
  <link rel="stylesheet" href="../styles/layout.css">
</head>
<body>
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <header class="header">
    <div class="header-content">
      <div class="header-left">
        <a href="../dashboard.html" class="header-logo">å‹¤æ€ ç®¡ç†</a>
        <nav class="header-nav">
          <a href="../dashboard.html" class="header-nav-link">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a>
          <a href="punch.html" class="header-nav-link">æ‰“åˆ»</a>
          <a href="gantt.html" class="header-nav-link">ã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆ</a>
          <a href="reports.html" class="header-nav-link">ãƒ¬ãƒãƒ¼ãƒˆ</a>
        </nav>
      </div>
      <div class="header-right">
        <a href="requests.html" class="header-nav-link">ç”³è«‹</a>
        <button id="time-mode-button" onclick="showTimeModeModal()" class="btn btn-sm btn-secondary" style="margin-right: var(--spacing-sm);">ç¾å®Ÿæ™‚é–“</button>
        <button onclick="logout()" class="btn btn-sm btn-secondary" style="margin-right: var(--spacing-sm);">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
        <a href="profile.html" class="header-user" style="text-decoration: none;">
          <div class="header-user-avatar"></div>
          <span class="header-user-name"></span>
        </a>
      </div>
    </div>
  </header>

  <!-- æ™‚é–“ãƒ¢ãƒ¼ãƒ‰è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="time-mode-modal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 500px;">
      <div class="modal-header">
        <h2 class="modal-title">æ™‚é–“ãƒ¢ãƒ¼ãƒ‰è¨­å®š</h2>
        <button class="modal-close" onclick="closeTimeModeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer; margin-bottom: var(--spacing-md);">
            <input type="radio" name="time-mode" id="time-mode-realtime" value="realtime" checked style="cursor: pointer;">
            <span>ç¾å®Ÿæ™‚é–“ã‚’æ¡ç”¨</span>
          </label>
          <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer; margin-bottom: var(--spacing-md);">
            <input type="radio" name="time-mode" id="time-mode-virtual" value="virtual" style="cursor: pointer;">
            <span>ä»®æƒ³æ™‚é–“ã‚’æ¡ç”¨</span>
          </label>
        </div>
        
        <div id="virtual-time-settings" style="display: none; margin-top: var(--spacing-lg); padding: var(--spacing-md); background: var(--bg-secondary); border-radius: var(--radius-md);">
          <div class="form-group">
            <label for="virtual-date" class="form-label required">æ—¥ä»˜</label>
            <input type="date" id="virtual-date" class="form-input" required>
          </div>
          <div class="form-group">
            <label for="virtual-time" class="form-label required">æ™‚åˆ»</label>
            <input type="time" id="virtual-time" class="form-input" required>
          </div>
          <div class="form-help" style="color: var(--text-secondary); font-size: var(--font-size-sm);">
            æ³¨æ„: ä»®æƒ³æ™‚é–“ã¯éå»ã®æ™‚é–“ã«æˆ»ã™ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
          </div>
        </div>
        
        <div style="margin-top: var(--spacing-xl); padding-top: var(--spacing-md); border-top: 1px solid var(--border-color);">
          <button onclick="resetDatabase()" class="btn btn-sm btn-danger" style="width: 100%;">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
          <div class="form-help" style="color: var(--text-secondary); font-size: var(--font-size-sm); margin-top: var(--spacing-xs);">
            ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã€ã‚¹ã‚­ãƒ¼ãƒã‚’å†é©ç”¨ã—ã¾ã™ã€‚æ™‚é–“ãƒ¢ãƒ¼ãƒ‰ã‚‚ç¾å®Ÿæ™‚é–“ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button onclick="saveTimeMode()" class="btn btn-primary">ä¿å­˜</button>
        <button onclick="closeTimeModeModal()" class="btn btn-secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      </div>
    </div>
  </div>

  <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
  <aside class="sidebar">
    <ul class="sidebar-menu">
      <li class="sidebar-menu-item">
        <a href="../dashboard.html" class="sidebar-menu-link">
          <span class="sidebar-menu-icon">ğŸ“Š</span>
          <span class="sidebar-menu-label">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</span>
        </a>
      </li>
      <li class="sidebar-menu-item">
        <a href="punch.html" class="sidebar-menu-link">
          <span class="sidebar-menu-icon">â°</span>
          <span class="sidebar-menu-label">æ‰“åˆ»</span>
        </a>
      </li>
      <li class="sidebar-menu-item">
        <a href="gantt.html" class="sidebar-menu-link">
          <span class="sidebar-menu-icon">ğŸ“…</span>
          <span class="sidebar-menu-label">ã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆ</span>
        </a>
      </li>
      <li class="sidebar-menu-item">
        <a href="requests.html" class="sidebar-menu-link">
          <span class="sidebar-menu-icon">ğŸ“</span>
          <span class="sidebar-menu-label">ç”³è«‹ãƒ»æ‰¿èª</span>
        </a>
      </li>
      <li class="sidebar-menu-item">
        <a href="employees.html" class="sidebar-menu-link active">
          <span class="sidebar-menu-icon">ğŸ‘¥</span>
          <span class="sidebar-menu-label">å¾“æ¥­å“¡ç®¡ç†</span>
        </a>
      </li>
      <li class="sidebar-menu-item">
        <a href="company-settings.html" class="sidebar-menu-link">
          <span class="sidebar-menu-icon">âš™ï¸</span>
          <span class="sidebar-menu-label">ä¼æ¥­è¨­å®š</span>
        </a>
      </li>
      <li class="sidebar-menu-item">
        <a href="reports.html" class="sidebar-menu-link">
          <span class="sidebar-menu-icon">ğŸ“ˆ</span>
          <span class="sidebar-menu-label">ãƒ¬ãƒãƒ¼ãƒˆ</span>
        </a>
      </li>
      <li class="sidebar-menu-item">
        <a href="payslip.html" class="sidebar-menu-link">
          <span class="sidebar-menu-icon">ğŸ’°</span>
          <span class="sidebar-menu-label">çµ¦ä¸æ˜ç´°</span>
        </a>
      </li>
      <li class="sidebar-menu-item">
        <a href="audit-logs.html" class="sidebar-menu-link">
          <span class="sidebar-menu-icon">ğŸ”</span>
          <span class="sidebar-menu-label">ç›£æŸ»ãƒ­ã‚°</span>
        </a>
      </li>
    </ul>
  </aside>

  <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <main class="main-content">
    <div class="page-header">
      <h1 class="page-title">å¾“æ¥­å“¡ç®¡ç†</h1>
      <p class="page-description">å¾“æ¥­å“¡ã®ä¸€è¦§ãƒ»ç™»éŒ²ãƒ»ç·¨é›†ã‚’è¡Œã„ã¾ã™</p>
      <div class="page-actions">
        <a href="#modal-new-employee" class="btn btn-primary">æ–°è¦å¾“æ¥­å“¡ç™»éŒ²</a>
        <a href="employee-invite.html" class="btn btn-secondary">å¾“æ¥­å“¡ã‚’æ‹›å¾…</a>
        <a href="departments.html" class="btn btn-secondary">éƒ¨ç½²ç®¡ç†</a>
        <a href="#modal-import" class="btn btn-secondary">CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ</a>
        <button class="btn btn-secondary" onclick="exportCSV()">CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
      </div>
    </div>

    <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒãƒ¼ -->
    <div class="filter-bar">
      <div class="filter-group">
        <label class="filter-label">éƒ¨ç½²:</label>
        <select class="form-select filter-input">
          <option value="">ã™ã¹ã¦</option>
          <option value="sales">å–¶æ¥­éƒ¨</option>
          <option value="dev">é–‹ç™ºéƒ¨</option>
          <option value="hr">äººäº‹éƒ¨</option>
        </select>
      </div>
      <div class="filter-group">
        <label class="filter-label">é›‡ç”¨å½¢æ…‹:</label>
        <select class="form-select filter-input">
          <option value="">ã™ã¹ã¦</option>
          <option value="full">æ­£ç¤¾å“¡</option>
          <option value="part">ãƒ‘ãƒ¼ãƒˆ</option>
          <option value="contract">å¥‘ç´„ç¤¾å“¡</option>
        </select>
      </div>
      <div class="filter-group">
        <label class="filter-label">æ¤œç´¢:</label>
        <input type="text" class="form-input filter-input" placeholder="åå‰ãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»ç¤¾å“¡ç•ªå·">
      </div>
      <div class="filter-group">
        <button class="btn btn-secondary">ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨</button>
      </div>
    </div>

    <!-- å¾“æ¥­å“¡ä¸€è¦§ -->
    <div class="card">
      <div class="card-body">
        <div class="table-container">
          <table class="table">
            <thead>
              <tr>
                <th>ç¤¾å“¡ç•ªå·</th>
                <th>æ°å</th>
                <th>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</th>
                <th>éƒ¨ç½²</th>
                <th>é›‡ç”¨å½¢æ…‹</th>
                <th>é›‡ç”¨æ—¥</th>
                <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                <th>æ“ä½œ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>EMP001</td>
                <td>å±±ç”°å¤ªéƒ</td>
                <td>yamada@example.com</td>
                <td>å–¶æ¥­éƒ¨</td>
                <td>æ­£ç¤¾å“¡</td>
                <td>2020-04-01</td>
                <td><span class="badge badge-success">åœ¨ç±</span></td>
                <td>
                  <a href="employee-detail.html" class="btn btn-sm btn-secondary">è©³ç´°</a>
                </td>
              </tr>
              <tr>
                <td>EMP002</td>
                <td>ä½è—¤èŠ±å­</td>
                <td>sato@example.com</td>
                <td>é–‹ç™ºéƒ¨</td>
                <td>æ­£ç¤¾å“¡</td>
                <td>2021-06-01</td>
                <td><span class="badge badge-success">åœ¨ç±</span></td>
                <td>
                  <a href="employee-detail.html" class="btn btn-sm btn-secondary">è©³ç´°</a>
                </td>
              </tr>
              <tr>
                <td>EMP003</td>
                <td>éˆ´æœ¨ä¸€éƒ</td>
                <td>suzuki@example.com</td>
                <td>äººäº‹éƒ¨</td>
                <td>æ­£ç¤¾å“¡</td>
                <td>2019-03-01</td>
                <td><span class="badge badge-success">åœ¨ç±</span></td>
                <td>
                  <a href="employee-detail.html" class="btn btn-sm btn-secondary">è©³ç´°</a>
                </td>
              </tr>
              <tr>
                <td>EMP004</td>
                <td>ç”°ä¸­æ¬¡éƒ</td>
                <td>tanaka@example.com</td>
                <td>å–¶æ¥­éƒ¨</td>
                <td>å¥‘ç´„ç¤¾å“¡</td>
                <td>2022-09-01</td>
                <td><span class="badge badge-warning">ä¼‘è·ä¸­</span></td>
                <td>
                  <a href="employee-detail.html" class="btn btn-sm btn-secondary">è©³ç´°</a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="pagination">
          <a href="#" class="pagination-link" style="pointer-events: none; opacity: 0.5;">&laquo;</a>
          <a href="#" class="pagination-link active">1</a>
          <a href="#" class="pagination-link">2</a>
          <a href="#" class="pagination-link">3</a>
          <a href="#" class="pagination-link">&raquo;</a>
        </div>
      </div>
    </div>

    <!-- æ–°è¦å¾“æ¥­å“¡ç™»éŒ²ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="modal-new-employee" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">æ–°è¦å¾“æ¥­å“¡ç™»éŒ²</h2>
          <a href="#" class="modal-close">&times;</a>
        </div>
        <div class="modal-body">
          <form id="form-new-employee">
            <div class="form-group">
              <label for="employee-code" class="form-label required">ç¤¾å“¡ç•ªå·</label>
              <input 
                type="text" 
                id="employee-code" 
                name="employee-code" 
                class="form-input" 
                required
                placeholder="ä¾‹: EMP001"
              >
            </div>

            <div class="form-group">
              <label for="employee-name" class="form-label required">æ°å</label>
              <input 
                type="text" 
                id="employee-name" 
                name="employee-name" 
                class="form-input" 
                required
              >
            </div>

            <div class="form-group">
              <label for="employee-email" class="form-label required">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
              <input 
                type="email" 
                id="employee-email" 
                name="employee-email" 
                class="form-input" 
                required
              >
            </div>

            <div class="form-group">
              <label for="employee-dept" class="form-label">éƒ¨ç½²</label>
              <select id="employee-dept" name="employee-dept" class="form-select">
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              </select>
            </div>

            <div class="form-group">
              <label for="employee-employment-type" class="form-label required">é›‡ç”¨å½¢æ…‹</label>
              <select id="employee-employment-type" name="employee-employment-type" class="form-select" required>
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="full_time">æ­£ç¤¾å“¡</option>
                <option value="part_time">ãƒ‘ãƒ¼ãƒˆ</option>
                <option value="contract">å¥‘ç´„ç¤¾å“¡</option>
              </select>
            </div>

            <div class="form-group">
              <label for="employee-hire-date" class="form-label required">é›‡ç”¨æ—¥</label>
              <input 
                type="date" 
                id="employee-hire-date" 
                name="employee-hire-date" 
                class="form-input" 
                required
              >
            </div>

            <div class="form-group">
              <label for="employee-work-location-tz" class="form-label">ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³</label>
              <select id="employee-work-location-tz" name="employee-work-location-tz" class="form-select">
                <option value="Asia/Tokyo" selected>Asia/Tokyo</option>
                <option value="UTC">UTC</option>
                <option value="America/New_York">America/New_York</option>
                <option value="Europe/London">Europe/London</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <a href="#" class="btn btn-secondary modal-close">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</a>
          <button type="button" class="btn btn-primary" onclick="createEmployee()">ç™»éŒ²</button>
        </div>
      </div>
    </div>

    <!-- å¾“æ¥­å“¡ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="modal-edit-employee" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">å¾“æ¥­å“¡æƒ…å ±ç·¨é›†</h2>
          <a href="#" class="modal-close">&times;</a>
        </div>
        <div class="modal-body">
          <form id="form-edit-employee">
            <input type="hidden" id="edit-employee-id">
            
            <div class="form-group">
              <label for="edit-employee-code" class="form-label">ç¤¾å“¡ç•ªå·</label>
              <input 
                type="text" 
                id="edit-employee-code" 
                name="edit-employee-code" 
                class="form-input" 
                readonly
                style="background-color: var(--bg-secondary);"
              >
              <div class="form-help">ç¤¾å“¡ç•ªå·ã¯å¤‰æ›´ã§ãã¾ã›ã‚“</div>
            </div>

            <div class="form-group">
              <label for="edit-employee-name" class="form-label required">æ°å</label>
              <input 
                type="text" 
                id="edit-employee-name" 
                name="edit-employee-name" 
                class="form-input" 
                required
              >
            </div>

            <div class="form-group">
              <label for="edit-employee-email" class="form-label required">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
              <input 
                type="email" 
                id="edit-employee-email" 
                name="edit-employee-email" 
                class="form-input" 
                required
              >
            </div>

            <div class="form-group">
              <label for="edit-employee-dept" class="form-label">éƒ¨ç½²</label>
              <select id="edit-employee-dept" name="edit-employee-dept" class="form-select">
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              </select>
            </div>

            <div class="form-group">
              <label for="edit-employee-employment-type" class="form-label required">é›‡ç”¨å½¢æ…‹</label>
              <select id="edit-employee-employment-type" name="edit-employee-employment-type" class="form-select" required>
                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                <option value="full_time">æ­£ç¤¾å“¡</option>
                <option value="part_time">ãƒ‘ãƒ¼ãƒˆ</option>
                <option value="contract">å¥‘ç´„ç¤¾å“¡</option>
              </select>
            </div>

            <div class="form-group">
              <label for="edit-employee-hire-date" class="form-label required">é›‡ç”¨æ—¥</label>
              <input 
                type="date" 
                id="edit-employee-hire-date" 
                name="edit-employee-hire-date" 
                class="form-input" 
                required
              >
            </div>

            <div class="form-group">
              <label for="edit-employee-leave-date" class="form-label">é€€è·æ—¥</label>
              <input 
                type="date" 
                id="edit-employee-leave-date" 
                name="edit-employee-leave-date" 
                class="form-input"
              >
            </div>

            <div class="form-group">
              <label for="edit-employee-status" class="form-label required">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
              <select id="edit-employee-status" name="edit-employee-status" class="form-select" required>
                <option value="active">åœ¨ç±</option>
                <option value="on_leave">ä¼‘è·ä¸­</option>
                <option value="retired">é€€è·</option>
              </select>
            </div>

            <div class="form-group">
              <label for="edit-employee-work-location-tz" class="form-label">ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³</label>
              <select id="edit-employee-work-location-tz" name="edit-employee-work-location-tz" class="form-select">
                <option value="Asia/Tokyo">Asia/Tokyo</option>
                <option value="UTC">UTC</option>
                <option value="America/New_York">America/New_York</option>
                <option value="Europe/London">Europe/London</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <a href="#" class="btn btn-secondary modal-close">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</a>
          <button type="button" class="btn btn-primary" onclick="updateEmployee()">æ›´æ–°</button>
        </div>
      </div>
    </div>

    <!-- CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="modal-import" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h2>
          <a href="#" class="modal-close">&times;</a>
        </div>
        <div class="modal-body">
          <div class="alert alert-info">
            <strong>å¾“æ¥­å“¡ã‚¤ãƒ³ãƒãƒ¼ãƒˆä»•æ§˜ï¼ˆä»•æ§˜æ›¸11.1ï¼‰:</strong><br>
            å¿…é ˆãƒ˜ãƒƒãƒ€: <code>employee_code</code>, <code>name</code>, <code>email</code>, <code>dept_code</code>, <code>employment_type</code>, <code>hire_date</code><br>
            ä»»æ„ãƒ˜ãƒƒãƒ€: <code>leave_date</code>, <code>work_location_tz</code><br>
            æ–‡å­—ã‚³ãƒ¼ãƒ‰: UTF-8ã€æ—¥ä»˜å½¢å¼: ISO8601ï¼ˆä¾‹: 2025-01-15ï¼‰
          </div>
          <form>
            <div class="form-group">
              <label for="csv-file" class="form-label required">CSVãƒ•ã‚¡ã‚¤ãƒ«</label>
              <input 
                type="file" 
                id="csv-file" 
                name="csv-file" 
                class="form-input"
                accept=".csv"
                required
              >
              <div class="form-help">UTF-8ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã®CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚é‡è¤‡ã™ã‚‹employee_codeã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™</div>
            </div>
            <div class="form-group">
              <label style="display: flex; align-items: center; gap: var(--spacing-xs); cursor: pointer;">
                <input type="checkbox" name="skip-duplicates" style="cursor: pointer;">
                <span>é‡è¤‡ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼ˆæ¨å¥¨: ã‚ªãƒ•ï¼‰</span>
              </label>
              <div class="form-help" style="font-size: var(--font-size-xs); color: var(--text-tertiary); margin-top: var(--spacing-xs);">
                é‡è¤‡ã™ã‚‹employee_codeãŒã‚ã‚‹å ´åˆã€ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦å ±å‘Šã•ã‚Œã¾ã™ï¼ˆä»•æ§˜æ›¸11.1ï¼‰
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <a href="#" class="btn btn-secondary modal-close">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</a>
          <button type="button" class="btn btn-primary" onclick="importCSV()">ã‚¤ãƒ³ãƒãƒ¼ãƒˆé–‹å§‹</button>
        </div>
      </div>
    </div>
  </main>
  <script src="../scripts/common.js"></script>
  <script>
    // ============================================
    // å¾“æ¥­å“¡ç®¡ç† - APIé€£æº
    // ============================================

    let employees = [];
    let departments = [];
    let currentPage = 1;
    let totalPages = 1;
    let filters = {
      dept_id: '',
      employment_type: '',
      search: '',
      status: ''
    };

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', async function() {
      await Promise.all([
        loadDepartments(),
        loadEmployees()
      ]);
      setupEventListeners();
      updateHeaderUserInfo();
      
      // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
      const urlParams = new URLSearchParams(window.location.search);
      const editId = urlParams.get('edit');
      if (editId) {
        await openEditModal(editId);
        // URLã‹ã‚‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰Šé™¤
        window.history.replaceState({}, document.title, window.location.pathname);
      }
    });

    // éƒ¨ç½²ä¸€è¦§ã‚’èª­ã¿è¾¼ã¿
    async function loadDepartments() {
      try {
        const response = await apiFetch(`${API_BASE_URL}/departments`);
        const data = await response.json();
        
        if (response.ok && data.success) {
          departments = data.data.items || [];
          
          // ãƒ•ã‚£ãƒ«ã‚¿ãƒãƒ¼ã®éƒ¨ç½²ã‚»ãƒ¬ã‚¯ãƒˆ
          const filterSelect = document.querySelector('.filter-bar select');
          if (filterSelect) {
            filterSelect.innerHTML = '<option value="">ã™ã¹ã¦</option>';
            departments.forEach(dept => {
              const option = document.createElement('option');
              option.value = dept.id;
              option.textContent = dept.name;
              filterSelect.appendChild(option);
            });
          }
          
          // æ–°è¦ç™»éŒ²ãƒ¢ãƒ¼ãƒ€ãƒ«ã®éƒ¨ç½²ã‚»ãƒ¬ã‚¯ãƒˆ
          const newDeptSelect = document.getElementById('employee-dept');
          if (newDeptSelect) {
            newDeptSelect.innerHTML = '<option value="">é¸æŠã—ã¦ãã ã•ã„</option>';
            departments.forEach(dept => {
              const option = document.createElement('option');
              option.value = dept.id;
              option.textContent = dept.name;
              newDeptSelect.appendChild(option);
            });
          }
          
          // ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã®éƒ¨ç½²ã‚»ãƒ¬ã‚¯ãƒˆ
          const editDeptSelect = document.getElementById('edit-employee-dept');
          if (editDeptSelect) {
            editDeptSelect.innerHTML = '<option value="">é¸æŠã—ã¦ãã ã•ã„</option>';
            departments.forEach(dept => {
              const option = document.createElement('option');
              option.value = dept.id;
              option.textContent = dept.name;
              editDeptSelect.appendChild(option);
            });
          }
        }
      } catch (error) {
        console.error('éƒ¨ç½²ä¸€è¦§ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
      }
    }

    // å¾“æ¥­å“¡ä¸€è¦§ã‚’èª­ã¿è¾¼ã¿
    async function loadEmployees(page = 1) {
      try {
        let url = `${API_BASE_URL}/employees?page=${page}&limit=20`;
        
        if (filters.dept_id) {
          url += `&dept_id=${filters.dept_id}`;
        }
        if (filters.status) {
          url += `&status=${filters.status}`;
        }
        
        const response = await apiFetch(url);
        const data = await response.json();
        
        if (response.ok && data.success) {
          employees = data.data.items || [];
          currentPage = data.data.page || 1;
          totalPages = data.data.total_pages || 1;
          renderEmployees();
          renderPagination();
        } else {
          console.error('å¾“æ¥­å“¡ä¸€è¦§å–å¾—ã‚¨ãƒ©ãƒ¼:', data);
          alert('å¾“æ¥­å“¡ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
        }
      } catch (error) {
        console.error('å¾“æ¥­å“¡ä¸€è¦§ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        alert('å¾“æ¥­å“¡ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    }

    // å¾“æ¥­å“¡ä¸€è¦§ã‚’æç”»
    function renderEmployees() {
      const tbody = document.querySelector('.table tbody');
      if (!tbody) return;

      tbody.innerHTML = '';

      if (employees.length === 0) {
        const row = document.createElement('tr');
        row.innerHTML = '<td colspan="8" style="text-align: center; padding: var(--spacing-lg); color: var(--text-secondary);">å¾“æ¥­å“¡ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</td>';
        tbody.appendChild(row);
        return;
      }

      // æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨
      let filteredEmployees = employees;
      if (filters.search) {
        const searchLower = filters.search.toLowerCase();
        filteredEmployees = employees.filter(emp => 
          emp.name.toLowerCase().includes(searchLower) ||
          emp.email.toLowerCase().includes(searchLower) ||
          emp.employee_code.toLowerCase().includes(searchLower)
        );
      }

      // é›‡ç”¨å½¢æ…‹ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨
      if (filters.employment_type) {
        const typeMap = {
          'full': 'full_time',
          'part': 'part_time',
          'contract': 'contract'
        };
        const filterType = typeMap[filters.employment_type];
        if (filterType) {
          filteredEmployees = filteredEmployees.filter(emp => emp.employment_type === filterType);
        }
      }

      filteredEmployees.forEach(employee => {
        const row = document.createElement('tr');
        
        const employmentTypeLabels = {
          'full_time': 'æ­£ç¤¾å“¡',
          'part_time': 'ãƒ‘ãƒ¼ãƒˆ',
          'contract': 'å¥‘ç´„ç¤¾å“¡'
        };

        const statusBadges = {
          'active': '<span class="badge badge-success">åœ¨ç±</span>',
          'on_leave': '<span class="badge badge-warning">ä¼‘è·ä¸­</span>',
          'retired': '<span class="badge badge-error">é€€è·</span>'
        };

        const hireDate = employee.hire_date ? new Date(employee.hire_date).toLocaleDateString('ja-JP') : '-';

        row.innerHTML = `
          <td>${employee.employee_code || '-'}</td>
          <td>${employee.name || '-'}</td>
          <td>${employee.email || '-'}</td>
          <td>${employee.department_name || '-'}</td>
          <td>${employmentTypeLabels[employee.employment_type] || employee.employment_type || '-'}</td>
          <td>${hireDate}</td>
          <td>${statusBadges[employee.status] || employee.status || '-'}</td>
          <td>
            <a href="employee-detail.html?id=${employee.id}" class="btn btn-sm btn-secondary" style="margin-right: var(--spacing-xs);">è©³ç´°</a>
            <button onclick="openEditModal('${employee.id}')" class="btn btn-sm btn-primary">ç·¨é›†</button>
          </td>
        `;
        
        tbody.appendChild(row);
      });
    }

    // ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’æç”»
    function renderPagination() {
      const pagination = document.querySelector('.pagination');
      if (!pagination) return;

      pagination.innerHTML = '';

      // å‰ã¸ãƒœã‚¿ãƒ³
      const prevLink = document.createElement('a');
      prevLink.href = '#';
      prevLink.className = 'pagination-link';
      prevLink.textContent = 'Â«';
      if (currentPage <= 1) {
        prevLink.style.pointerEvents = 'none';
        prevLink.style.opacity = '0.5';
      } else {
        prevLink.addEventListener('click', (e) => {
          e.preventDefault();
          loadEmployees(currentPage - 1);
        });
      }
      pagination.appendChild(prevLink);

      // ãƒšãƒ¼ã‚¸ç•ªå·
      for (let i = 1; i <= totalPages; i++) {
        const pageLink = document.createElement('a');
        pageLink.href = '#';
        pageLink.className = 'pagination-link';
        if (i === currentPage) {
          pageLink.classList.add('active');
        }
        pageLink.textContent = i;
        pageLink.addEventListener('click', (e) => {
          e.preventDefault();
          loadEmployees(i);
        });
        pagination.appendChild(pageLink);
      }

      // æ¬¡ã¸ãƒœã‚¿ãƒ³
      const nextLink = document.createElement('a');
      nextLink.href = '#';
      nextLink.className = 'pagination-link';
      nextLink.textContent = 'Â»';
      if (currentPage >= totalPages) {
        nextLink.style.pointerEvents = 'none';
        nextLink.style.opacity = '0.5';
      } else {
        nextLink.addEventListener('click', (e) => {
          e.preventDefault();
          loadEmployees(currentPage + 1);
        });
      }
      pagination.appendChild(nextLink);
    }

    // æ–°è¦å¾“æ¥­å“¡ã‚’ä½œæˆ
    async function createEmployee() {
      const employeeCode = document.getElementById('employee-code').value;
      const name = document.getElementById('employee-name').value;
      const email = document.getElementById('employee-email').value;
      const deptId = document.getElementById('employee-dept').value;
      const employmentType = document.getElementById('employee-employment-type').value;
      const hireDate = document.getElementById('employee-hire-date').value;
      const workLocationTz = document.getElementById('employee-work-location-tz').value;

      if (!employeeCode || !name || !email || !employmentType || !hireDate) {
        alert('ã™ã¹ã¦ã®å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      try {
        const requestData = {
          employee_code: employeeCode,
          name: name,
          email: email,
          dept_id: deptId || null,
          employment_type: employmentType,
          hire_date: hireDate,
          work_location_tz: workLocationTz
        };

        const response = await apiFetch(`${API_BASE_URL}/employees`, {
          method: 'POST',
          body: JSON.stringify(requestData)
        });

        const data = await response.json();

        if (response.ok && data.success) {
          alert('å¾“æ¥­å“¡ã‚’ç™»éŒ²ã—ã¾ã—ãŸ');
          document.getElementById('modal-new-employee').style.display = 'none';
          document.getElementById('form-new-employee').reset();
          await loadEmployees(1);
        } else {
          console.error('å¾“æ¥­å“¡ç™»éŒ²ã‚¨ãƒ©ãƒ¼:', data);
          alert('å¾“æ¥­å“¡ã®ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + (data.error?.message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'));
        }
      } catch (error) {
        console.error('å¾“æ¥­å“¡ç™»éŒ²ã‚¨ãƒ©ãƒ¼:', error);
        alert('å¾“æ¥­å“¡ã®ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    }

    // å¾“æ¥­å“¡ã‚’æ›´æ–°
    async function updateEmployee() {
      const employeeId = document.getElementById('edit-employee-id').value;
      const name = document.getElementById('edit-employee-name').value;
      const email = document.getElementById('edit-employee-email').value;
      const deptId = document.getElementById('edit-employee-dept').value;
      const employmentType = document.getElementById('edit-employee-employment-type').value;
      const hireDate = document.getElementById('edit-employee-hire-date').value;
      const leaveDate = document.getElementById('edit-employee-leave-date').value;
      const status = document.getElementById('edit-employee-status').value;
      const workLocationTz = document.getElementById('edit-employee-work-location-tz').value;

      if (!name || !email || !employmentType || !hireDate || !status) {
        alert('ã™ã¹ã¦ã®å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      try {
        const requestData = {
          name: name,
          email: email,
          dept_id: deptId || null,
          employment_type: employmentType,
          hire_date: hireDate,
          leave_date: leaveDate || null,
          status: status,
          work_location_tz: workLocationTz
        };

        const response = await apiFetch(`${API_BASE_URL}/employees/${employeeId}`, {
          method: 'PUT',
          body: JSON.stringify(requestData)
        });

        const data = await response.json();

        if (response.ok && data.success) {
          alert('å¾“æ¥­å“¡æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
          document.getElementById('modal-edit-employee').style.display = 'none';
          await loadEmployees(currentPage);
        } else {
          console.error('å¾“æ¥­å“¡æ›´æ–°ã‚¨ãƒ©ãƒ¼:', data);
          alert('å¾“æ¥­å“¡æƒ…å ±ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + (data.error?.message || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'));
        }
      } catch (error) {
        console.error('å¾“æ¥­å“¡æ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
        alert('å¾“æ¥­å“¡æƒ…å ±ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    }

    // ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    async function openEditModal(employeeId) {
      try {
        const response = await apiFetch(`${API_BASE_URL}/employees/${employeeId}`);
        const data = await response.json();
        
        if (response.ok && data.success) {
          const emp = data.data;
          
          document.getElementById('edit-employee-id').value = emp.id;
          document.getElementById('edit-employee-code').value = emp.employee_code || '';
          document.getElementById('edit-employee-name').value = emp.name || '';
          document.getElementById('edit-employee-email').value = emp.email || '';
          document.getElementById('edit-employee-dept').value = emp.dept_id || '';
          document.getElementById('edit-employee-employment-type').value = emp.employment_type || '';
          document.getElementById('edit-employee-hire-date').value = emp.hire_date || '';
          document.getElementById('edit-employee-leave-date').value = emp.leave_date || '';
          document.getElementById('edit-employee-status').value = emp.status || 'active';
          document.getElementById('edit-employee-work-location-tz').value = emp.work_location_tz || 'Asia/Tokyo';
          
          document.getElementById('modal-edit-employee').style.display = 'block';
        } else {
          console.error('å¾“æ¥­å“¡è©³ç´°å–å¾—ã‚¨ãƒ©ãƒ¼:', data);
          alert('å¾“æ¥­å“¡æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
        }
      } catch (error) {
        console.error('å¾“æ¥­å“¡è©³ç´°ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        alert('å¾“æ¥­å“¡æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
    function setupEventListeners() {
      // ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨ãƒœã‚¿ãƒ³
      const filterButton = document.querySelector('.filter-bar button');
      if (filterButton) {
        filterButton.addEventListener('click', function() {
          const deptSelect = document.querySelector('.filter-bar select');
          const employmentSelect = document.querySelectorAll('.filter-bar select')[1];
          const searchInput = document.querySelector('.filter-bar input[type="text"]');
          
          filters.dept_id = deptSelect ? deptSelect.value : '';
          filters.employment_type = employmentSelect ? employmentSelect.value : '';
          filters.search = searchInput ? searchInput.value : '';
          
          loadEmployees(1);
        });
      }

      // æ–°è¦å¾“æ¥­å“¡ç™»éŒ²ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
      const newEmployeeLink = document.querySelector('a[href="#modal-new-employee"]');
      if (newEmployeeLink) {
        newEmployeeLink.addEventListener('click', function(e) {
          e.preventDefault();
          const modal = document.getElementById('modal-new-employee');
          if (modal) {
            modal.style.display = 'block';
            // é›‡ç”¨æ—¥ã‚’ä»Šæ—¥ã®æ—¥ä»˜ã«è¨­å®š
            const hireDateInput = document.getElementById('employee-hire-date');
            if (hireDateInput && !hireDateInput.value) {
              const today = new Date();
              hireDateInput.value = today.toISOString().split('T')[0];
            }
          }
        });
      }

      // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
      document.querySelectorAll('.modal-close').forEach(closeBtn => {
        closeBtn.addEventListener('click', function(e) {
          e.preventDefault();
          const modal = this.closest('.modal');
          if (modal) {
            modal.style.display = 'none';
          }
        });
      });

      // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', function(e) {
          if (e.target === this) {
            this.style.display = 'none';
          }
        });
      });
    }

    // CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ
    async function importCSV() {
      const fileInput = document.getElementById('csv-file');
      const skipDuplicates = document.querySelector('input[name="skip-duplicates"]').checked;

      if (!fileInput.files || fileInput.files.length === 0) {
        alert('CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
      }

      const file = fileInput.files[0];
      const text = await file.text();
      
      // CSVã‚’ãƒ‘ãƒ¼ã‚¹
      const lines = text.split('\n').filter(line => line.trim());
      if (lines.length < 2) {
        alert('CSVãƒ•ã‚¡ã‚¤ãƒ«ãŒç©ºã‹ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã¿ã§ã™');
        return;
      }

      // ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å–å¾—
      const headers = lines[0].split(',').map(h => h.trim());
      const requiredHeaders = ['employee_code', 'name', 'email', 'employment_type', 'hire_date'];
      
      for (const header of requiredHeaders) {
        if (!headers.includes(header)) {
          alert(`å¿…é ˆãƒ˜ãƒƒãƒ€ãƒ¼ "${header}" ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
          return;
        }
      }

      // ãƒ‡ãƒ¼ã‚¿è¡Œã‚’å‡¦ç†
      const results = {
        success: 0,
        failed: 0,
        errors: []
      };

      for (let i = 1; i < lines.length; i++) {
        const values = lines[i].split(',').map(v => v.trim());
        const row = {};
        headers.forEach((header, index) => {
          row[header] = values[index] || '';
        });

        try {
          // é›‡ç”¨å½¢æ…‹ã®å¤‰æ›
          const employmentTypeMap = {
            'full_time': 'full_time',
            'part_time': 'part_time',
            'contract': 'contract',
            'full': 'full_time',
            'part': 'part_time'
          };
          const employmentType = employmentTypeMap[row.employment_type] || row.employment_type;

          // éƒ¨ç½²ã‚³ãƒ¼ãƒ‰ã‹ã‚‰éƒ¨ç½²IDã‚’å–å¾—
          let deptId = null;
          if (row.dept_code) {
            const dept = departments.find(d => d.code === row.dept_code);
            if (dept) {
              deptId = dept.id;
            }
          }

          const requestData = {
            employee_code: row.employee_code,
            name: row.name,
            email: row.email,
            dept_id: deptId,
            employment_type: employmentType,
            hire_date: row.hire_date,
            work_location_tz: row.work_location_tz || 'Asia/Tokyo'
          };

          const response = await apiFetch(`${API_BASE_URL}/employees`, {
            method: 'POST',
            body: JSON.stringify(requestData)
          });

          const data = await response.json();

          if (response.ok && data.success) {
            results.success++;
          } else {
            if (skipDuplicates && data.error?.code === 'CONFLICT') {
              // é‡è¤‡ã‚’ã‚¹ã‚­ãƒƒãƒ—
              results.success++;
            } else {
              results.failed++;
              results.errors.push(`è¡Œ ${i + 1}: ${data.error?.message || 'ã‚¨ãƒ©ãƒ¼'}`);
            }
          }
        } catch (error) {
          results.failed++;
          results.errors.push(`è¡Œ ${i + 1}: ${error.message}`);
        }
      }

      // çµæœã‚’è¡¨ç¤º
      let message = `ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Œäº†\næˆåŠŸ: ${results.success}ä»¶\nå¤±æ•—: ${results.failed}ä»¶`;
      if (results.errors.length > 0 && results.errors.length <= 10) {
        message += '\n\nã‚¨ãƒ©ãƒ¼è©³ç´°:\n' + results.errors.join('\n');
      } else if (results.errors.length > 10) {
        message += `\n\nï¼ˆã‚¨ãƒ©ãƒ¼ãŒ${results.errors.length}ä»¶ã‚ã‚Šã¾ã™ï¼‰`;
      }
      alert(message);

      if (results.success > 0) {
        document.getElementById('modal-import').style.display = 'none';
        fileInput.value = '';
        await loadEmployees(1);
      }
    }

    // CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
    async function exportCSV() {
      try {
        // å…¨å¾“æ¥­å“¡ã‚’å–å¾—
        const response = await apiFetch(`${API_BASE_URL}/employees?limit=10000`);
        const data = await response.json();
        
        if (!response.ok || !data.success) {
          alert('å¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
          return;
        }

        const employees = data.data.items || [];
        
        if (employees.length === 0) {
          alert('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“');
          return;
        }

        // CSVãƒ˜ãƒƒãƒ€ãƒ¼
        const headers = ['employee_code', 'name', 'email', 'dept_code', 'employment_type', 'hire_date', 'leave_date', 'work_location_tz', 'status'];
        
        // CSVãƒ‡ãƒ¼ã‚¿è¡Œ
        const rows = employees.map(emp => {
          const dept = departments.find(d => d.id === emp.dept_id);
          return [
            emp.employee_code || '',
            emp.name || '',
            emp.email || '',
            dept ? (dept.code || '') : '',
            emp.employment_type || '',
            emp.hire_date || '',
            emp.leave_date || '',
            emp.work_location_tz || 'Asia/Tokyo',
            emp.status || 'active'
          ].map(v => `"${String(v).replace(/"/g, '""')}"`).join(',');
        });

        // CSVæ–‡å­—åˆ—ã‚’ç”Ÿæˆ
        const csvContent = [headers.join(','), ...rows].join('\n');
        
        // BOMã‚’è¿½åŠ ï¼ˆExcelã§æ–‡å­—åŒ–ã‘ã‚’é˜²ãï¼‰
        const BOM = '\uFEFF';
        const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
        
        // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `employees_${new Date().toISOString().split('T')[0]}.csv`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
      } catch (error) {
        console.error('CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼:', error);
        alert('CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    }

    // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹
    window.createEmployee = createEmployee;
    window.updateEmployee = updateEmployee;
    window.openEditModal = openEditModal;
    window.importCSV = importCSV;
    window.exportCSV = exportCSV;
  </script>
</body>
</html>

