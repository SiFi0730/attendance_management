-- ============================================
-- シードデータ（開発・テスト用）
-- ============================================

-- ⚠️ セキュリティ警告:
--   このファイルは開発・テスト環境専用です。
--   本番環境では絶対に使用しないでください。
--   テスト用のパスワードとメールアドレスが含まれています。
--   GitHub等で公開する場合は、このファイルの内容を確認してください。

-- ============================================
-- 1. システム管理者ユーザー
-- ============================================
-- パスワード: Admin123! (bcrypt hash)
INSERT INTO users (id, email, password_hash, name, status, mfa_enabled) VALUES
    ('00000000-0000-0000-0000-000000000001', 'admin@system.local', 
     '$2b$10$rQZ8X5K5X5K5X5K5X5K5Xe5X5X5X5X5X5X5X5X5X5X5X5X5X5X5X', 
     'システム管理者', 'active', false)
ON CONFLICT (id) DO NOTHING;

-- ============================================
-- 2. テスト用テナント
-- ============================================
INSERT INTO tenants (id, name, timezone, locale, status) VALUES
    ('10000000-0000-0000-0000-000000000001', '株式会社サンプル', 'Asia/Tokyo', 'ja', 'active'),
    ('10000000-0000-0000-0000-000000000002', '株式会社テクノロジー', 'Asia/Tokyo', 'ja', 'active')
ON CONFLICT (id) DO NOTHING;

-- ============================================
-- 3. テスト用ユーザー
-- ============================================
-- パスワード: Password123! (bcrypt hash - 実際の実装では適切なハッシュを使用)
INSERT INTO users (id, email, password_hash, name, status, mfa_enabled) VALUES
    ('20000000-0000-0000-0000-000000000001', 'admin@sample.co.jp', 
     '$2b$10$rQZ8X5K5X5K5X5K5X5K5Xe5X5X5X5X5X5X5X5X5X5X5X5X5X5X5X', 
     '企業管理者', 'active', false),
    ('20000000-0000-0000-0000-000000000002', 'yamada@sample.co.jp', 
     '$2b$10$rQZ8X5K5X5K5X5K5X5K5Xe5X5X5X5X5X5X5X5X5X5X5X5X5X5X5X', 
     '山田太郎', 'active', false),
    ('20000000-0000-0000-0000-000000000003', 'sato@sample.co.jp', 
     '$2b$10$rQZ8X5K5X5K5X5K5X5K5Xe5X5X5X5X5X5X5X5X5X5X5X5X5X5X5X', 
     '佐藤花子', 'active', false)
ON CONFLICT (id) DO NOTHING;

-- ============================================
-- 4. 役割割り当て
-- ============================================
INSERT INTO role_assignments (id, tenant_id, user_id, role, scope_type) VALUES
    -- システム管理者
    ('30000000-0000-0000-0000-000000000001', NULL, '00000000-0000-0000-0000-000000000001', 'SystemAdmin', 'all'),
    -- 企業管理者
    ('30000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', 'CompanyAdmin', 'all'),
    -- 従業員
    ('30000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000002', 'Employee', NULL),
    ('30000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000003', 'Employee', NULL)
ON CONFLICT (id) DO NOTHING;

-- ============================================
-- 5. 部署
-- ============================================
INSERT INTO departments (id, tenant_id, name, code) VALUES
    ('40000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001', '営業部', 'SALES'),
    ('40000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', '開発部', 'DEV'),
    ('40000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000001', '人事部', 'HR')
ON CONFLICT (id) DO NOTHING;

-- 営業一部、営業二部（営業部の子部署）
INSERT INTO departments (id, tenant_id, name, code, parent_id) VALUES
    ('40000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000001', '営業一部', 'SALES1', '40000000-0000-0000-0000-000000000001'),
    ('40000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000001', '営業二部', 'SALES2', '40000000-0000-0000-0000-000000000001')
ON CONFLICT (id) DO NOTHING;

-- ============================================
-- 6. 従業員プロファイル
-- ============================================
INSERT INTO employee_profiles (id, tenant_id, user_id, employee_code, name, email, dept_id, employment_type, hire_date, status) VALUES
    ('50000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000002', 
     'EMP001', '山田太郎', 'yamada@sample.co.jp', '40000000-0000-0000-0000-000000000001', 'full_time', '2020-04-01', 'active'),
    ('50000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000003', 
     'EMP002', '佐藤花子', 'sato@sample.co.jp', '40000000-0000-0000-0000-000000000002', 'full_time', '2021-06-01', 'active')
ON CONFLICT (id) DO NOTHING;

-- ============================================
-- 7. 営業時間設定（会社全体）
-- ============================================
INSERT INTO business_hours (id, tenant_id, scope_type, weekday, start_time, end_time) VALUES
    -- 月曜日〜金曜日: 9:00-18:00
    ('60000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001', 'company', 1, '09:00', '18:00'),
    ('60000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', 'company', 2, '09:00', '18:00'),
    ('60000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000001', 'company', 3, '09:00', '18:00'),
    ('60000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000001', 'company', 4, '09:00', '18:00'),
    ('60000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000001', 'company', 5, '09:00', '18:00')
ON CONFLICT (id) DO NOTHING;

-- ============================================
-- 8. 就業ルールセット
-- ============================================
INSERT INTO rule_sets (id, tenant_id, name, version, effective_from, config) VALUES
    ('70000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001', '基本就業ルール', 1, '2020-01-01', 
     '{
       "rounding": {
         "start": 5,
         "end": 5,
         "total": 5
       },
       "overtime_calculation": "daily",
       "night_work": {
         "start": "22:00",
         "end": "05:00"
       }
     }'::jsonb)
ON CONFLICT (id) DO NOTHING;

-- ============================================
-- 9. 祝日カレンダー（2025年）
-- ============================================
INSERT INTO holiday_calendars (id, tenant_id, scope_type, date, name, type) VALUES
    ('80000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000001', 'company', '2025-01-01', '元日', 'holiday'),
    ('80000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', 'company', '2025-01-13', '成人の日', 'holiday'),
    ('80000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000001', 'company', '2025-02-11', '建国記念の日', 'holiday')
ON CONFLICT (id) DO NOTHING;

-- ============================================
-- 注意事項
-- ============================================
-- 1. パスワードハッシュは実際の実装で適切なbcrypt/Argon2ハッシュを使用してください
-- 2. 本番環境では、このシードデータは使用せず、適切な初期化スクリプトを作成してください
-- 3. テスト環境でのみ使用することを推奨します

